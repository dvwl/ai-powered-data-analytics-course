---
lab:
    title: 'Excel Mastery for Data Analysis'
---
# Module 1: Excel Mastery for Data Analysis

## Dataset

**Download:** [`ice-cream-weather-dataset.csv`](../data/ice-cream-weather-dataset.csv)
> Disclaimer: Data is generated by AI.

This dataset contains daily ice cream sales data spanning January to June 2024, with the following columns:
- **Date**: Date of sales (YYYY-MM-DD format)
- **Location**: Sales location (Downtown, Beach Park, Mall Central) - *Contains inconsistent formatting*
- **Temperature (F)**: Daily temperature in Fahrenheit
- **Ice-cream Price ($)**: Price per ice cream unit in dollars
- **Number of Tourists (thousands)**: Tourist count in thousands
- **Ice Cream Sales ($,thousands)**: Ice cream sales in thousands of dollars
- **Did it rain on that day?**: Weather condition (Yes/No for rain)

**Note**: The Location column contains typical data quality issues found in real-world datasets including inconsistent capitalization (lowercase, UPPERCASE, MiXeD cAsE) and extra spaces that need cleaning.

---

## Lab 1: Excel Functions – Cleaning and Enriching the Dataset

### Objective

Prepare the dataset for analysis by cleaning text, formatting columns, and creating calculated columns.

### Steps

1. **Open the Dataset** in Excel.
2. **Clean Up Text Columns**:

   * Use `TRIM()` to remove extra spaces from Location column (leading/trailing spaces).
   * Apply `PROPER()` to standardize capitalization for location names (converts to Title Case).
   * Example: `=PROPER(TRIM(B2))` 
   * **What you'll find**: 
     - `" downtown "` becomes `"Downtown"`
     - `"BEACH PARK"` becomes `"Beach Park"`
     - `"mAlL cEnTrAl "` becomes `"Mall Central"`
   * **Why this matters**: Consistent formatting prevents duplicate categories in pivot tables and ensures accurate data analysis.

3. **Convert Date and Numeric Columns**:

   * Ensure `Date` column (A) is formatted as `Date` type.
   * Ensure `Temperature (F)` (C), `Ice-cream Price ($)` (D), `Number of Tourists (thousands)` (E), and `Ice Cream Sales ($,thousands)` (F) are `Number` types.

4. **Create a "Temperature Category" Column** (Column I):

   * Formula: `=IF(C2>=85, "Hot", IF(C2>=70, "Warm", "Cool"))`
   * This categorizes temperatures: Cool (<70°F), Warm (70-84°F), Hot (≥85°F)

5. **Create a "Temperature (C)" Column** (Column J):

   * Formula: `=(C2-32)*5/9` to convert Fahrenheit to Celsius
   * Format the column to 1 decimal place

6. **Create a "Temperature Toggle" Feature** (Columns K):

   * In cell K1, create a dropdown with "Fahrenheit" and "Celsius" options:
     - Select cell K1, go to Data → Data Validation
     - Allow: List, Source: `Fahrenheit,Celsius`
   * In column K (starting K2), create a formula to display temperature based on toggle:
     - Formula: `=IF($K$1="Celsius", I2, C2)`
     - This shows Celsius when "Celsius" is selected, Fahrenheit otherwise

7. **Update Temperature Category for International Use** (Column L):

   * Formula: `=IF($J$1="Celsius", IF(I2>=29, "Hot", IF(I2>=21, "Warm", "Cool")), IF(C2>=85, "Hot", IF(C2>=70, "Warm", "Cool")))`
   * This adjusts categories based on unit: 
     - Celsius: Cool (<21°C), Warm (21-28°C), Hot (≥29°C)
     - Fahrenheit: Cool (<70°F), Warm (70-84°F), Hot (≥85°F)

8. **Create a "Month" Column** (Column M):

   * Formula: `=TEXT(A2,"mmmm")` to extract month name from date

9. **Create a "Sales Performance" Column** (Column N):

   * Formula: `=IF(F2>=100, "High", IF(F2>=75, "Medium", "Low"))`

10. **Create a "Weather Flag" Column** (Column O):

    * Formula: `=IF(G2="Yes", "Rainy", "Dry")`

### Save As

Save a copy as `cleaned-ice-cream-weather.xlsx`

---

## Lab 2: Pivot Tables – Sales Analysis by Weather

### Objective

Analyze the relationship between weather and ice cream sales using pivot tables.

### Steps

1. **Insert Pivot Table** from the cleaned dataset.
2. **Fields to Use**:

   * Rows: `Temperature Category` (use the international version from Column L), `Weather Flag`
   * Values: `Ice Cream Sales ($,thousands)` (Sum)
   * Columns: `Location`
   
3. **Add Slicer**:

   * Insert slicer for `Month` to filter by time period
   * Add slicer for temperature unit toggle if needed

4. **Add a Calculated Field**:

   * Create a calculated field: `Sales per Tourist`
   * Formula: `=Ice Cream Sales ($,thousands)/Number of Tourists (thousands)`

5. **Format Pivot Table**:

   * Apply currency formatting to sales values ($)
   * Add grand totals for rows and columns

---

## Lab 3: Excel Dashboard – Executive Summary

### Objective

Create an interactive dashboard to visualize trends in ice cream sales.

### Steps

1. **Create Summary Charts**:

   * Line Chart: `Date` vs. `Ice Cream Sales ($,thousands)` (showing trends over time)
   * Bar Chart: `Location` vs. `Average Ice Cream Sales ($,thousands)`
   * Column Chart: `Weather Flag` vs. `Total Ice Cream Sales ($,thousands)`
   * Scatter Plot: `Temperature (Selected Unit)` vs. `Ice Cream Sales ($,thousands)` (to show correlation)
   * Scatter Plot: `Number of Tourists (thousands)` vs. `Ice Cream Sales ($,thousands)`
   * **Note**: Use the `Temperature (Selected Unit)` column (K) for temperature-related charts to respect the user's unit preference

2. **Add Sparklines**:

   * Insert sparklines for each location's daily sales trends
   * Group data by location to show mini trend charts

3. **Apply Conditional Formatting**:

   * Highlight high sales days (>$100k): Green fill
   * Highlight low sales on hot days: `=AND(F2<75, C2>85)` - Red fill
   * Use data bars for the `Ice Cream Sales ($,thousands)` column to show relative performance
   * Color scale for `Number of Tourists (thousands)` to show tourist density

4. **Add Interactive Filters**:

   * Insert slicers for `Location`, `Month`, and `Weather Flag`
   * Connect slicers to all charts for dynamic filtering
   * **Temperature Unit Control**: Include the temperature toggle dropdown (J1) prominently on the dashboard for easy unit switching

5. **Design the Layout**:

   * Organize the dashboard on a new sheet named `Executive Dashboard`
   * Create sections: "Key Metrics", "Trends", "Performance by Location", "Tourist Impact"
   * **Add Temperature Unit Indicator**: Display current temperature unit prominently
   * Use consistent fonts (Arial 11pt), professional colors, and clear titles

6. **Add Summary Statistics**:

   * Total Sales: `=SUM(Ice Cream Sales ($,thousands))`
   * Average Daily Sales: `=AVERAGE(Ice Cream Sales ($,thousands))`
   * Average Price: `=AVERAGE(Ice-cream Price ($))`
   * Total Tourists: `=SUM(Number of Tourists (thousands))`
   * Best Performing Location: Use INDEX/MATCH functions
   * Weather Impact Analysis: Compare average sales on rainy vs dry days

---

## Next Module Preview

In **Module 2**, we will recreate some of these insights using SQL queries on the same dataset hosted in a database.
